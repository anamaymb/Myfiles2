#include<stdio.h>
#include<stdlib.h>
#include<math.h>

float weights[10][100],weights_prev[10][100];

float output[10],expectedOp[10],ExNum[10]={20,16,16,22,21,23,15,24,23,20};

float input[10][100]={

                     {0 , 0 , 0 , 0 , 1 , 1 , 0 , 0 , 0 , 0 ,       //1                                     1
                      0 , 0 , 0 , 0 , 1 , 1 , 0 , 0 , 0 , 0 ,       //2
                      0 , 0 , 0 , 0 , 1 , 1 , 0 , 0 , 0 , 0 ,       //3
                      0 , 0 , 0 , 0 , 1 , 1 , 0 , 0 , 0 , 0 ,       //4
                      0 , 0 , 0 , 0 , 1 , 1 , 0 , 0 , 0 , 0 ,       //5
                      0 , 0 , 0 , 0 , 1 , 1 , 0 , 0 , 0 , 0 ,       //6
                      0 , 0 , 0 , 0 , 1 , 1 , 0 , 0 , 0 , 0 ,       //7
                      0 , 0 , 0 , 0 , 1 , 1 , 0 , 0 , 0 , 0 ,       //8
                      0 , 0 , 0 , 0 , 1 , 1 , 0 , 0 , 0 , 0 ,       //9
                      0 , 0 , 0 , 0 , 1 , 1 , 0 , 0 , 0 , 0 },      //10

                     {0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 ,       //1                                     2
                      0 , 0 , 0 , 0 , 1 , 1 , 0 , 0 , 0 , 0 ,       //2
                      0 , 0 , 0 , 1 , 0 , 0 , 1 , 0 , 0 , 0 ,       //3
                      0 , 0 , 1 , 0 , 0 , 0 , 1 , 0 , 0 , 0 ,       //4
                      0 , 0 , 0 , 0 , 0 , 0 , 1 , 0 , 0 , 0 ,       //5
                      0 , 0 , 0 , 0 , 0 , 1 , 0 , 0 , 0 , 0 ,       //6
                      0 , 0 , 0 , 0 , 1 , 0 , 0 , 0 , 0 , 0 ,       //7
                      0 , 0 , 0 , 1 , 0 , 0 , 0 , 0 , 0 , 0 ,       //8
                      0 , 0 , 1 , 1 , 1 , 1 , 1 , 1 , 0 , 0 ,       //9
                      0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 },      //10

                     {0 , 0 , 0 , 0 , 1 , 1 , 0 , 0 , 0 , 0 ,       //1                                      3
                      0 , 0 , 0 , 1 , 0 , 0 , 1 , 0 , 0 , 0 ,       //2
                      0 , 0 , 1 , 0 , 0 , 0 , 1 , 0 , 0 , 0 ,       //3
                      0 , 0 , 0 , 0 , 0 , 1 , 0 , 0 , 0 , 0 ,       //4
                      0 , 0 , 0 , 0 , 1 , 0 , 0 , 0 , 0 , 0 ,       //5
                      0 , 0 , 0 , 0 , 0 , 1 , 0 , 0 , 0 , 0 ,       //6
                      0 , 0 , 0 , 0 , 0 , 0 , 1 , 0 , 0 , 0 ,       //7
                      0 , 0 , 1 , 0 , 0 , 0 , 1 , 0 , 0 , 0 ,       //8
                      0 , 0 , 0 , 1 , 0 , 0 , 1 , 0 , 0 , 0 ,       //9
                      0 , 0 , 0 , 0 , 1 , 1 , 0 , 0 , 0 , 0 },

                     {0 , 0 , 0 , 0 , 0 , 0 , 1 , 0 , 0 , 0 ,       //1                                      4
                      0 , 0 , 0 , 0 , 0 , 1 , 1 , 0 , 0 , 0 ,       //2
                      0 , 0 , 0 , 0 , 1 , 0 , 1 , 0 , 0 , 0 ,       //3
                      0 , 0 , 0 , 1 , 0 , 0 , 1 , 0 , 0 , 0 ,       //4
                      0 , 0 , 1 , 0 , 0 , 0 , 1 , 0 , 0 , 0 ,       //5
                      0 , 1 , 0 , 0 , 0 , 0 , 1 , 0 , 0 , 0 ,       //6
                      0 , 1 , 1 , 1 , 1 , 1 , 1 , 1 , 1 , 0 ,       //7
                      0 , 0 , 0 , 0 , 0 , 0 , 1 , 0 , 0 , 0 ,       //8
                      0 , 0 , 0 , 0 , 0 , 0 , 1 , 0 , 0 , 0 ,       //9
                      0 , 0 , 0 , 0 , 0 , 0 , 1 , 0 , 0 , 0 },      //10

                     {0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 ,       //1                                      5
                      0 , 0 , 1 , 1 , 1 , 1 , 1 , 1 , 0 , 0 ,       //2
                      0 , 0 , 1 , 0 , 0 , 0 , 0 , 0 , 0 , 0 ,       //3
                      0 , 0 , 1 , 0 , 0 , 0 , 0 , 0 , 0 , 0 ,       //4
                      0 , 0 , 1 , 1 , 1 , 1 , 1 , 0 , 0 , 0 ,       //5
                      0 , 0 , 0 , 0 , 0 , 0 , 0 , 1 , 0 , 0 ,       //6
                      0 , 0 , 0 , 0 , 0 , 0 , 0 , 1 , 0 , 0 ,       //7
                      0 , 0 , 0 , 0 , 0 , 0 , 0 , 1 , 0 , 0 ,       //8
                      0 , 0 , 1 , 1 , 1 , 1 , 1 , 0 , 0 , 0 ,       //9
                      0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 },      //10

                     {0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 ,       //1                                      6
                      0 , 0 , 0 , 1 , 1 , 1 , 1 , 0 , 0 , 0 ,       //2
                      0 , 0 , 1 , 0 , 0 , 0 , 0 , 1 , 0 , 0 ,       //3
                      0 , 0 , 1 , 0 , 0 , 0 , 0 , 0 , 0 , 0 ,       //4
                      0 , 0 , 1 , 1 , 1 , 1 , 1 , 0 , 0 , 0 ,       //5
                      0 , 0 , 1 , 0 , 0 , 0 , 0 , 1 , 0 , 0 ,       //6
                      0 , 0 , 1 , 0 , 0 , 0 , 0 , 1 , 0 , 0 ,       //7
                      0 , 0 , 1 , 0 , 0 , 0 , 0 , 1 , 0 , 0 ,       //8
                      0 , 0 , 0 , 1 , 1 , 1 , 1 , 0 , 0 , 0 ,       //9
                      0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 },      //10

                     {0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 ,       //1                                     7
                      0 , 0 , 1 , 1 , 1 , 1 , 1 , 1 , 1 , 0 ,       //2
                      0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 1 , 0 ,       //3
                      0 , 0 , 0 , 0 , 0 , 0 , 0 , 1 , 0 , 0 ,       //4
                      0 , 0 , 0 , 0 , 0 , 0 , 1 , 0 , 0 , 0 ,       //5
                      0 , 0 , 0 , 0 , 0 , 1 , 0 , 0 , 0 , 0 ,       //6
                      0 , 0 , 0 , 0 , 1 , 0 , 0 , 0 , 0 , 0 ,       //7
                      0 , 0 , 0 , 1 , 0 , 0 , 0 , 0 , 0 , 0 ,       //8
                      0 , 0 , 1 , 0 , 0 , 0 , 0 , 0 , 0 , 0 ,       //9
                      0 , 1 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 },      //10

                     {0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 ,       //1                                     8
                      0 , 0 , 0 , 1 , 1 , 1 , 1 , 0 , 0 , 0 ,       //2
                      0 , 0 , 1 , 0 , 0 , 0 , 0 , 1 , 0 , 0 ,       //3
                      0 , 0 , 1 , 0 , 0 , 0 , 0 , 1 , 0 , 0 ,       //4
                      0 , 0 , 1 , 0 , 0 , 0 , 0 , 1 , 0 , 0 ,       //5
                      0 , 0 , 1 , 1 , 1 , 1 , 1 , 1 , 0 , 0 ,       //6
                      0 , 0 , 1 , 0 , 0 , 0 , 0 , 1 , 0 , 0 ,       //7
                      0 , 0 , 1 , 0 , 0 , 0 , 0 , 1 , 0 , 0 ,       //8
                      0 , 0 , 0 , 1 , 1 , 1 , 1 , 0 , 0 , 0 ,       //9
                      0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 },      //10

                     {0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 ,       //1                                     9
                      0 , 0 , 0 , 1 , 1 , 1 , 1 , 0 , 0 , 0 ,       //2
                      0 , 0 , 1 , 0 , 0 , 0 , 0 , 1 , 0 , 0 ,       //3
                      0 , 0 , 1 , 0 , 0 , 0 , 0 , 1 , 0 , 0 ,       //4
                      0 , 0 , 1 , 0 , 0 , 0 , 0 , 1 , 0 , 0 ,       //5
                      0 , 0 , 1 , 1 , 1 , 1 , 1 , 1 , 0 , 0 ,       //6
                      0 , 0 , 0 , 0 , 0 , 0 , 0 , 1 , 0 , 0 ,       //7
                      0 , 0 , 0 , 0 , 0 , 0 , 0 , 1 , 0 , 0 ,       //8
                      0 , 0 , 1 , 1 , 1 , 1 , 1 , 0 , 0 , 0 ,       //9
                      0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 },      //10

                     {0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 ,       //1                                     0
                      0 , 0 , 0 , 1 , 1 , 1 , 1 , 0 , 0 , 0 ,       //2
                      0 , 0 , 1 , 0 , 0 , 0 , 0 , 1 , 0 , 0 ,       //3
                      0 , 0 , 1 , 0 , 0 , 0 , 0 , 1 , 0 , 0 ,       //4
                      0 , 0 , 1 , 0 , 0 , 0 , 0 , 1 , 0 , 0 ,       //5
                      0 , 0 , 1 , 0 , 0 , 0 , 0 , 1 , 0 , 0 ,       //6
                      0 , 0 , 1 , 0 , 0 , 0 , 0 , 1 , 0 , 0 ,       //7
                      0 , 0 , 1 , 0 , 0 , 0 , 0 , 1 , 0 , 0 ,       //8
                      0 , 0 , 0 , 1 , 1 , 1 , 1 , 0 , 0 , 0 ,       //9
                      0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 },      //10
                      };

float calculateOp(int j,float h,int nthWeight, int nthRow)
{
    float op=0;
    for (int k=0;k<100;k++)
        op=op+input[nthRow][k]*(weights[j][k]+h*(k==nthWeight && j==nthRow));
    
    return op;
}


float sumOfSquares(int nthWeight, float offset, int nthRow)
{
    float sum=0;
    for(int i=nthRow;i<=nthRow;i++)
        sum=sum+(expectedOp[i]-calculateOp(i,offset,nthWeight,nthRow))*(expectedOp[i]-calculateOp(i,offset,nthWeight,nthRow));
    return sum;
}


float calculateOpPrev(int j,float h,int nthWeight,int nthRow)
{
    float op=0;
    for (int k=0;k<100;k++)
        op=op+input[nthRow][k]*(weights_prev[j][k]+h*(k==nthWeight && j==nthRow));

    return op;
}


float sumOfPrevSquares(int nthWeight, float h, int nthRow)
{
    float sum=0;
    for(int i=nthRow;i<=nthRow;i++)
        sum=sum+(expectedOp[i]-calculateOpPrev(i,h,nthWeight,nthRow))*(expectedOp[i]-calculateOpPrev(i,h,nthWeight,nthRow));
    return sum;
}



int main()
{

for(int number=0; number<10;number++)
{
    for(int i=0;i<10;i++)
    {
        expectedOp[i]=0;
        if(i==number)
            expectedOp[i]=ExNum[i];
    }
    for(int j=0;j<100;j++)
    {
        weights[number][j]=0;weights_prev[number][j]=0;
    }

    
    float kp[10]={0.004 , 0.005 , 0.004 , 0.0035 , 0.003 , 0.0022 ,0.0052 ,0.002 ,0.002 ,0.004}, h=0.01;
            //      2       1       3       4       5       6       7       8       9       0

//          {       16,     20,     16,     22,     21,     23,     15,     24,     23,     20};

    for (int count=0;count<100;count++)
    {
        // printf("%f \n",sumOfSquares(0,0,number));
        for(int i=0;i<100;i++)
        {
            if(sumOfPrevSquares(i,0,number)>sumOfPrevSquares(i,h,number))
            {
                weights[number][i]=weights[number][i]+kp[number]*abs(sumOfPrevSquares(0,0,number));
            }
            else if(sumOfPrevSquares(i,0,number)>sumOfPrevSquares(i,-h,number))
            {
                weights[number][i]=weights[number][i]-kp[number]*abs(sumOfPrevSquares(0,0,number));
            }
        }

        for(int i=0;i<100;i++)
            weights_prev[number][i]=weights[number][i];

    }


    for(int i=0;i<100;i++)
    {
        if(i%10==0)
            printf("\n\n");
        
        if(weights[number][i]!=0)
            printf("%f ",weights[number][i]);
        else
            printf("         ");
    }

    printf("\n");
}


  float TestIp[100]= {0 , 0 , 0 , 0 , 0 , 0 , 1 , 0 , 0 , 0 ,       //1                                    4
                      0 , 0 , 0 , 0 , 0 , 1 , 1 , 0 , 0 , 0 ,       //2
                      0 , 0 , 0 , 0 , 1 , 0 , 1 , 0 , 0 , 0 ,       //3
                      0 , 0 , 0 , 1 , 0 , 0 , 1 , 0 , 0 , 0 ,       //4
                      0 , 0 , 1 , 0 , 0 , 0 , 1 , 0 , 0 , 0 ,       //5
                      0 , 1 , 0 , 0 , 0 , 0 , 1 , 0 , 0 , 0 ,       //6
                      0 , 1 , 1 , 1 , 1 , 1 , 1 , 1 , 1 , 0 ,       //7
                      0 , 0 , 0 , 0 , 0 , 0 , 1 , 0 , 0 , 0 ,       //8
                      0 , 0 , 0 , 0 , 0 , 0 , 1 , 0 , 0 , 0 ,       //9
                      0 , 0 , 0 , 0 , 0 , 0 , 1 , 0 , 0 , 0 };      //10

    float highest=0;
    for(int j=0;j<10;j++)
    {
        output[j]=0;
        for(int i=0;i<100;i++)
            output[j]+=weights[j][i]*TestIp[i];
        if(highest<output[j])
        highest=output[j];
    }
    for(int j=0;j<10;j++)
        printf("%f\n",output[j]/highest);

    return 0;
}